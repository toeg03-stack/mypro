<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ThomasLab | QR Master Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root[data-theme="dark"] {
            --bg-color: #0f172a;
            --card-bg: #1e293b;
            --text-main: #f8fafc;
            --accent: #38bdf8;
            --border: rgba(255, 255, 255, 0.1);
        }
        :root[data-theme="light"] {
            --bg-color: #f1f5f9;
            --card-bg: #ffffff;
            --text-main: #1e293b;
            --accent: #0284c7;
            --border: rgba(0, 0, 0, 0.1);
        }

        body { 
            font-family: 'Cairo', sans-serif; 
            background-color: var(--bg-color); 
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .main-header {
            background: var(--card-bg);
            padding: 0.8rem 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
            z-index: 100;
        }

        /* Ù‡ÙŠØ¯Ø± Ø§Ù„Ø£Ø¯ÙˆØ§Øª (Ø§Ù„Ø«Ø§Ù†ÙŠ) */
        .tools-nav {
            backdrop-filter: blur(10px);
            padding: 10px;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 90;
        }

        .glass-card { 
            background: var(--card-bg); 
            border: 1px solid var(--border);
            border-radius: 24px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2);
        }

        .custom-input {
            width: 100%;
            background-color: rgba(15, 23, 42, 0.5);
            border: 1px solid var(--border);
            padding: 12px 16px;
            border-radius: 14px;
            color: var(--text-main);
            outline: none;
            transition: 0.2s;
        }
        [data-theme="light"] .custom-input { background-color: #f8fafc; color: #1e293b; }

        .active-tab { 
            background: var(--accent) !important; 
            color: white !important; 
            box-shadow: 0 4px 12px rgba(56, 189, 248, 0.3);
        }

        .tool-section { display: none; }
        .tool-section.active { display: block; animation: fadeIn 0.5s ease; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        footer { background: var(--card-bg); border-top: 1px solid var(--border); }
    </style>
</head>
<body>

    <header class="main-header">
        <div class="flex items-center">
            <a href="index.html" class="bg-slate-700 text-white px-3 py-1 rounded-lg text-sm ml-4 hover:bg-slate-600 transition">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
            <div class="flex items-center">
                <h1 class="text-lg font-black tracking-tight">ThomasLab <span class="font-light opacity-70">| QR Tools</span></h1>
            </div>
        </div>
        <button onclick="toggleTheme()" class="border border-sky-500 text-sky-500 px-4 py-1 rounded-full text-sm hover:bg-sky-500 hover:text-white transition">ğŸŒ“ Ø§Ù„Ù…Ø¸Ù‡Ø±</button>
    </header>

    <nav class="tools-nav">
    <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-center items-center gap-2">
        <div class="flex justify-center bg-slate-800/50 p-1 rounded-xl md:w-auto overflow-x-auto no-scrollbar gap-1">
            <button onclick="showTool(1)" id="tab1" class="flex-none px-4 py-2 rounded-lg transition-all font-bold text-xs md:text-sm text-slate-400 hover:text-white">ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªØ³Ù„Ø³Ù„ (ZIP)</button>
            <button onclick="showTool(2)" id="tab2" class="flex-none px-4 py-2 rounded-lg transition-all font-bold text-xs md:text-sm text-slate-400 hover:text-white">ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© (PDF)</button>
            <button onclick="showTool(3)" id="tab3" class="flex-none px-4 py-2 rounded-lg transition-all font-bold text-xs md:text-sm text-slate-400 hover:text-white">Ø§Ù„Ø¯Ù…Ø¬ Ø§Ù„Ø°ÙƒÙŠ (Direct)</button>
            <button onclick="showTool(4)" id="tab4" class="flex-none px-4 py-2 rounded-lg transition-all font-bold text-xs md:text-sm active-tab">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥ÙƒØ³ÙŠÙ„ (Excel)</button>
            <button onclick="showTool(5)" id="tab5" class="flex-none px-4 py-2 rounded-lg transition-all font-bold text-xs md:text-sm text-slate-400 hover:text-white">ÙƒØ±ÙˆØª Ø§Ù„Ù‡ÙˆÙŠØ© (ID Cards)</button>
        </div>
    </div>
</nav>

    <main style="padding-top: 1.3rem;" class="max-w-5xl mx-auto px-4 py-8 flex-grow w-full">
        
        <section id="tool1" class="tool-section transition-all">
            <div class="glass-card p-6 md:p-10">
                <div class="mb-8 border-r-4 border-sky-500 pr-4">
                    <h2 class="text-2xl font-black">Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙƒÙˆØ§Ø¯ QR Ù…ØªØ³Ù„Ø³Ù„Ø©</h2>
                    <p class="opacity-60 text-sm mt-1">Ù‚Ù… Ø¨ØªÙˆÙ„ÙŠØ¯ Ù…Ø¦Ø§Øª Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ù…Ø¹ Ø£Ø±Ù‚Ø§Ù…Ù‡Ø§ Ø¨Ø¶ØºØ·Ø© Ø²Ø± ÙˆØ§Ø­Ø¯Ø©</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div>
                        <label class="block text-xs font-bold mb-2 opacity-70">Ø±Ù‚Ù… Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</label>
                        <input type="number" id="t1Start" value="1" class="custom-input">
                    </div>
                    <div>
                        <label class="block text-xs font-bold mb-2 opacity-70">Ø±Ù‚Ù… Ø§Ù„Ù†Ù‡Ø§ÙŠØ©</label>
                        <input type="number" id="t1End" value="10" class="custom-input">
                    </div>
                    <div>
                        <label class="block text-xs font-bold mb-2 opacity-70">Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ (PX)</label>
                        <input type="number" id="t1Size" value="300" class="custom-input">
                    </div>
                </div>
                <button onclick="generateT1()" id="btnT1" class="w-full bg-sky-600 hover:bg-sky-500 text-white font-black py-4 rounded-2xl shadow-lg transition-all flex items-center justify-center gap-3">
                    Ø¨Ø¯Ø¡ Ø§Ù„ØªÙˆÙ„ÙŠØ¯ ÙˆØ§Ù„ØªØ­Ù…ÙŠÙ„ (ZIP)
                </button>
                <div id="statusT1" class="mt-6 text-center font-bold text-sky-400 animate-pulse min-h-[1.5rem]"></div>
            </div>
        </section>

        <section id="tool2" class="tool-section">
            <div class="glass-card p-6 md:p-10">
                <div class="mb-8 border-r-4 border-emerald-500 pr-4">
                    <h2 class="text-2xl font-black">ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ± Ø¥Ù„Ù‰ PDF</h2>
                    <p class="opacity-60 text-sm mt-1">Ø§Ø±ÙØ¹ ØµÙˆØ±Ùƒ Ø£Ùˆ Ù…Ù„Ù Ø§Ù„Ù€ ZIP Ø§Ù„Ø°ÙŠ Ù‚Ù…Øª Ø¨ØªÙˆÙ„ÙŠØ¯Ù‡ Ø³Ø§Ø¨Ù‚Ø§Ù‹</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-6">
                    <label class="group relative flex flex-col items-center justify-center p-10 border-2 border-dashed border-slate-700 rounded-3xl cursor-pointer hover:border-emerald-500 transition-all text-center">
                        <span class="opacity-60 font-bold">Ø§Ø±ÙØ¹ ZIP Ø£Ùˆ ØµÙˆØ± ÙØ±Ø¯ÙŠØ©</span>
                        <input type="file" id="t2Input" multiple accept="image/*,.zip" class="hidden">
                        <div id="t2Count" class="mt-2 text-xs font-bold text-emerald-400 bg-emerald-500/10 px-3 py-1 rounded-full hidden"></div>
                    </label>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="col-span-2">
                            <label class="block text-xs font-bold opacity-60 mb-1">Ø§Ø³Ù… Ù…Ù„Ù Ø§Ù„Ù€ PDF</label>
                            <input type="text" id="t2Name" placeholder="QR_Print_File" class="custom-input font-bold">
                        </div>
                        <div><label class="block text-[10px] font-bold opacity-60 mb-1">Ø£Ø¹Ù…Ø¯Ø© x ØµÙÙˆÙ</label>
                            <div class="flex gap-1"><input type="number" id="t2Cols" value="5" class="custom-input text-center"><input type="number" id="t2Rows" value="7" class="custom-input text-center"></div>
                        </div>
                        <div><label class="block text-[10px] font-bold opacity-60 mb-1">Ø§Ù„Ù…Ø³Ø§ÙØ© (Ù…Ù…)</label><input type="number" id="t2Spacing" value="3" class="custom-input text-center font-bold"></div>
                    </div>
                </div>
                <button onclick="generateT2()" id="btnT2" class="w-full bg-emerald-600 hover:bg-emerald-500 text-white font-black py-4 rounded-2xl shadow-lg transition-all">Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF</button>
                <div id="statusT2" class="mt-4 text-center font-bold text-emerald-400 animate-pulse"></div>
            </div>
        </section>

        <section id="tool3" class="tool-section transition-all">
            <div class="glass-card p-6 md:p-10 border-sky-500/30">
                <div class="mb-8 border-r-4 border-sky-600 pr-4">
                    <h2 class="text-2xl font-black">Ø§Ù„Ø¯Ù…Ø¬ Ø§Ù„Ø°ÙƒÙŠ: Ù…Ù† Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø¥Ù„Ù‰ PDF</h2>
                    <p class="opacity-60 text-sm mt-1">ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ ÙˆØªØ±ØªÙŠØ¨Ù‡Ø§ ÙÙŠ Ù…Ù„Ù PDF ÙˆØ§Ø­Ø¯ Ø¨Ø¶ØºØ·Ø© Ø²Ø±</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                    <div class="space-y-4">
                        <h3 class="font-black text-sky-400 border-b border-white/10 pb-2">1. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£ÙƒÙˆØ§Ø¯</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div><label class="block text-xs font-bold opacity-60 mb-1">Ø±Ù‚Ù… Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</label><input type="number" id="t3Start" value="1" class="custom-input"></div>
                            <div><label class="block text-xs font-bold opacity-60 mb-1">Ø±Ù‚Ù… Ø§Ù„Ù†Ù‡Ø§ÙŠØ©</label><input type="number" id="t3End" value="50" class="custom-input"></div>
                        </div>
                        <div><label class="block text-xs font-bold opacity-60 mb-1">Ø§Ø³Ù… Ù…Ù„Ù Ø§Ù„Ù€ PDF Ø§Ù„Ù†Ø§ØªØ¬</label><input type="text" id="t3Name" placeholder="QR_Work_Order" class="custom-input font-bold text-sky-400"></div>
                    </div>
                    <div class="space-y-4">
                        <h3 class="font-black text-emerald-400 border-b border-white/10 pb-2">2. ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© (A4)</h3>
                        <div class="grid grid-cols-3 gap-2">
                            <div><label class="block text-[10px] font-bold opacity-60 mb-1 text-center">Ø£Ø¹Ù…Ø¯Ø©</label><input type="number" id="t3Cols" value="5" class="custom-input text-center font-bold"></div>
                            <div><label class="block text-[10px] font-bold opacity-60 mb-1 text-center">ØµÙÙˆÙ</label><input type="number" id="t3Rows" value="7" class="custom-input text-center font-bold"></div>
                            <div><label class="block text-[10px] font-bold opacity-60 mb-1 text-center">Ø§Ù„Ù…Ø³Ø§ÙØ©(Ù…Ù…)</label><input type="number" id="t3Spacing" value="3" class="custom-input text-center font-bold"></div>
                        </div>
                    </div>
                </div>
                <button onclick="generateT3()" id="btnT3" class="w-full bg-sky-600 hover:bg-sky-500 text-white font-black py-4 rounded-2xl shadow-xl transform transition-all text-lg">
                    ØªÙˆÙ„ÙŠØ¯ ÙˆØ­ÙØ¸ Ù…Ù„Ù PDF Ø§Ù„Ø¢Ù†
                </button>
                <div id="statusT3" class="mt-6 text-center font-bold text-sky-400 animate-pulse min-h-[1.5rem]"></div>
            </div>
        </section>

        <section id="tool4" class="tool-section active transition-all">
            <div class="glass-card p-6 md:p-10 border-amber-500/50 shadow-amber-900/10">
                <div class="mb-8 border-r-4 border-amber-500 pr-4">
                    <h2 class="text-2xl font-black">Ù…Ù† Ø¥ÙƒØ³ÙŠÙ„ Ø¥Ù„Ù‰ PDF</h2>
                    <p class="opacity-60 text-sm mt-1">Ø¥Ù†Ø´Ø§Ø¡ QR Ù…Ø®ØµØµ Ù„ÙƒÙ„ Ø§Ø³Ù… Ù…Ù† Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                    <div class="space-y-4">
                        <h3 class="font-black text-amber-500 border-b border-white/10 pb-2">1. Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
                        <label class="block">
                            <span class="text-xs font-bold opacity-60">Ø§Ø®ØªØ± Ù…Ù„Ù Excel Ø£Ùˆ CSV</span>
                            <input type="file" id="t4Excel" accept=".xlsx, .xls, .csv" class="mt-1 block w-full border-2 border-dashed border-slate-700 p-4 rounded-2xl text-sm">
                        </label>
                        <input type="text" id="t4Name" placeholder="Ø§Ø³Ù… Ù…Ù„Ù Ø§Ù„Ù€ PDF Ø§Ù„Ù†Ø§ØªØ¬" class="custom-input font-bold text-amber-500">
                    </div>
                    <div class="space-y-4">
                        <h3 class="font-black text-emerald-400 border-b border-white/10 pb-2">2. ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØµÙØ­Ø©</h3>
                        <div class="grid grid-cols-3 gap-2">
                            <div><label class="text-[10px] font-bold block text-center opacity-60">Ø£Ø¹Ù…Ø¯Ø©</label><input type="number" id="t4Cols" value="5" class="custom-input text-center font-bold"></div>
                            <div><label class="text-[10px] font-bold block text-center opacity-60">ØµÙÙˆÙ</label><input type="number" id="t4Rows" value="7" class="custom-input text-center font-bold"></div>
                            <div><label class="text-[10px] font-bold block text-center opacity-60">Ù…Ø³Ø§ÙØ©(Ù…Ù…)</label><input type="number" id="t4Spacing" value="3" class="custom-input text-center font-bold"></div>
                        </div>
                    </div>
                </div>
                <button onclick="processExcel()" id="btnT4" class="w-full bg-amber-600 hover:bg-amber-500 text-white font-black py-5 rounded-2xl shadow-xl transition-all text-lg">Ù…Ø¹Ø§Ù„Ø¬Ø© ÙˆØªØµØ¯ÙŠØ± PDF</button>
                <div id="statusT4" class="mt-6 text-center font-bold text-amber-500 animate-pulse min-h-[0.5rem]"></div>
            </div>
        </section>

        <section id="tool5" class="tool-section transition-all">
    <div class="glass-card p-6 md:p-10 border-indigo-500/50 shadow-indigo-900/10">
        <div class="mb-8 border-r-4 border-indigo-500 pr-4">
            <h2 class="text-2xl font-black">Ù…Ù†Ø´Ø¦ ÙƒØ±ÙˆØª Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„Ø©</h2>
            <p class="opacity-60 text-sm mt-1">Ù…Ù‚Ø§Ø³ 65x45 Ù…Ù… | 18 ÙƒØ§Ø±Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø©</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
            <div class="space-y-4">
                <h3 class="font-black text-indigo-400 border-b border-white/10 pb-2">1. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØºÙŠØ±Ø© ÙˆØ§Ù„Ø´ÙƒÙ„</h3>
                <label class="block">
                    <span class="text-xs font-bold opacity-60">Ù…Ù„Ù Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ ÙˆØ§Ù„Ø£ÙƒÙˆØ§Ø¯</span>
                    <input type="file" id="t5Excel" accept=".xlsx, .xls, .csv" class="mt-1 block w-full border-2 border-dashed border-slate-700 p-3 rounded-xl text-sm">
                </label>
                <div class="flex items-center gap-4 bg-slate-800/50 p-3 rounded-xl">
                    <span class="text-xs font-bold opacity-70">Ù„ÙˆÙ† Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø¨Ø±ÙˆØ§Ø²:</span>
                    <input type="color" id="t5Color" value="#0284c7" class="h-10 w-20 rounded cursor-pointer bg-transparent">
                </div>
                <input type="text" id="t5FileName" placeholder="Ø§Ø³Ù… Ù…Ù„Ù Ø§Ù„Ù€ PDF Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ" class="custom-input font-bold text-indigo-400">
            </div>

            <div class="space-y-4">
                <h3 class="font-black text-emerald-400 border-b border-white/10 pb-2">2. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© ÙˆØ§Ù„Ø´Ø¹Ø§Ø±Ø§Øª</h3>
                <div class="grid grid-cols-2 gap-2">
                    <input type="text" id="t5ServiceName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø©" class="custom-input text-sm">
                    <input type="text" id="t5LevelName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø±Ø­Ù„Ø©" class="custom-input text-sm">
                </div>
                <div class="grid grid-cols-2 gap-2">
                    <label class="block">
                        <span class="text-[10px] font-bold opacity-50">Ù„ÙˆØ¬Ùˆ Ø§Ù„Ø®Ø¯Ù…Ø© (ÙŠÙ…ÙŠÙ†)</span>
                        <input type="file" id="t5ServiceLogo" accept="image/*" class="text-[10px] w-full">
                    </label>
                    <label class="block">
                        <span class="text-[10px] font-bold opacity-50">Ù„ÙˆØ¬Ùˆ Ø§Ù„Ù…Ø±Ø­Ù„Ø© (ÙŠØ³Ø§Ø±)</span>
                        <input type="file" id="t5LevelLogo" accept="image/*" class="text-[10px] w-full">
                    </label>
                </div>
            </div>
        </div>

        <button onclick="processIDCards()" id="btnT5" class="w-full bg-indigo-600 hover:bg-indigo-500 text-white font-black py-5 rounded-2xl shadow-xl transition-all text-lg">Ø¥Ù†Ø´Ø§Ø¡ ÙˆØªØµØ¯ÙŠØ± 18 ÙƒØ§Ø±Øª/ØµÙØ­Ø©</button>
<div id="progressContainerT5" class="hidden mt-8 space-y-3">
    <div class="flex justify-between items-end">
        <div class="flex flex-col">
            <span id="currentActionT5" class="text-xs font-bold text-indigo-400">Ø¬Ø§Ø±ÙŠ Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...</span>
            <span id="currentPersonT5" class="text-sm font-black text-white truncate max-w-[200px]">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>
        </div>
        <span id="percentTextT5" class="text-2xl font-black text-indigo-500">0%</span>
    </div>
    <div class="w-full bg-slate-800 rounded-full h-3 overflow-hidden border border-white/5">
        <div id="progressBarT5" class="bg-indigo-500 h-full w-0 transition-all duration-300 ease-out shadow-[0_0_15px_rgba(99,102,241,0.5)]"></div>
    </div>
</div>
<div id="statusT5" class="mt-4 text-center font-bold text-indigo-500 min-h-[1rem]"></div>    </div>
</section>

        

    </main>

    <footer class="py-4">
        <div class="max-w-6xl mx-auto text-center text-xs font-bold opacity-60">
            Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© &copy; 2026 <a target="_blank" href="https://www.linkedin.com/in/tomaseg" class="text-sky-400 underline ml-1">ThomasLab's</a>
        </div>
    </footer>

    <div id="temp-qr" class="hidden"></div>
    <canvas id="finalCanvas" class="hidden"></canvas>

    <script>
        function toggleTheme() {
            const html = document.documentElement;
            const current = html.getAttribute('data-theme');
            html.setAttribute('data-theme', current === 'dark' ? 'light' : 'dark');
        }

        function showTool(n) {
            document.querySelectorAll('.tool-section').forEach(s => s.classList.remove('active'));
            document.getElementById('tool' + n).classList.add('active');
            [1,2,3,4].forEach(i => {
                document.getElementById('tab'+i).classList.remove('active-tab');
            });
            document.getElementById('tab' + n).classList.add('active-tab');
        }

        document.getElementById('t2Input').addEventListener('change', function(e) {
            const el = document.getElementById('t2Count');
            if(e.target.files.length > 0) {
                el.innerText = e.target.files[0].name.endsWith('.zip') ? "âœ… Ù…Ù„Ù ZIP Ø¬Ø§Ù‡Ø²" : `âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ${e.target.files.length} ØµÙˆØ±Ø©`;
                el.classList.remove('hidden');
            }
        });

        async function generateT1() {
            const start = parseInt(document.getElementById('t1Start').value), end = parseInt(document.getElementById('t1End').value), size = parseInt(document.getElementById('t1Size').value);
            const status = document.getElementById('statusT1'); const zip = new JSZip();
            status.innerText = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆÙ„ÙŠØ¯...";
            const canvas = document.getElementById('finalCanvas'); const ctx = canvas.getContext('2d');
            canvas.width = size + (size*0.2); canvas.height = size + (size*0.35);
            for(let i=start; i<=end; i++){
                status.innerText = `ğŸ”„ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ÙƒÙˆØ¯: ${i}`;
                const div = document.getElementById('temp-qr'); div.innerHTML = "";
                new QRCode(div, {text: i.toString(), width: size, height: size});
                await new Promise(r => setTimeout(r, 40));
                ctx.fillStyle = "white"; ctx.fillRect(0,0,canvas.width, canvas.height);
                ctx.drawImage(div.querySelector('canvas'), size*0.1, size*0.1);
                ctx.fillStyle = "black"; ctx.font = `bold ${size*0.12}px Cairo`; ctx.textAlign="center";
                ctx.fillText(i.toString(), canvas.width/2, size + (size*0.25));
                zip.file(`QR_${i}.png`, canvas.toDataURL("image/png").split(',')[1], {base64: true});
            }
            saveAs(await zip.generateAsync({type:"blob"}), `QR_Series_${start}_to_${end}.zip`);
            status.innerText = "âœ… ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!";
        }

        async function generateT2() {
            const files = document.getElementById('t2Input').files, customName = document.getElementById('t2Name').value || "QR_Print_Job";
            const status = document.getElementById('statusT2'); if(files.length === 0) return alert("Ø§Ø®ØªØ± Ù…Ù„ÙØ§Øª Ø£ÙˆÙ„Ø§Ù‹");
            status.innerText = "ğŸš€ Ø¬Ø§Ø±ÙŠ ØªØ¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ±...";
            let images = [];
            if(files[0].name.endsWith('.zip')){
                const zip = await new JSZip().loadAsync(files[0]);
                for(let path in zip.files) if(!zip.files[path].dir && /\.(png|jpg|jpeg)$/i.test(path)) images.push("data:image/png;base64," + await zip.files[path].async("base64"));
            } else {
                for(let f of files) images.push(await new Promise(r => { const fr = new FileReader(); fr.onload=e=>r(e.target.result); fr.readAsDataURL(f); }));
            }
            const { jsPDF } = window.jspdf; const doc = new jsPDF('p', 'mm', 'a4');
            const cols = parseInt(document.getElementById('t2Cols').value), rows = parseInt(document.getElementById('t2Rows').value), sp = parseInt(document.getElementById('t2Spacing').value);
            const w = (190 - (sp*(cols-1)))/cols, h = (277 - (sp*(rows-1)))/rows;
            let c=0, r=0;
            images.forEach((img, i) => {
                doc.addImage(img, 'PNG', 10+(c*(w+sp)), 10+(r*(h+sp)), w, h);
                c++; if(c>=cols){ c=0; r++; }
                if(r>=rows && i < images.length-1){ doc.addPage(); c=0; r=0; }
            });
            doc.save(`${customName}.pdf`); status.innerText = "âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸!";
        }

        async function generateT3() {
            const start = parseInt(document.getElementById('t3Start').value), end = parseInt(document.getElementById('t3End').value), customName = document.getElementById('t3Name').value || "Direct_QR_Print";
            const cols = parseInt(document.getElementById('t3Cols').value), rows = parseInt(document.getElementById('t3Rows').value), sp = parseInt(document.getElementById('t3Spacing').value);
            const status = document.getElementById('statusT3'); const { jsPDF } = window.jspdf; const doc = new jsPDF('p', 'mm', 'a4');
            const w = (190 - (sp*(cols-1)))/cols, h = (277 - (sp*(rows-1)))/rows;
            const canvas = document.getElementById('finalCanvas'); const ctx = canvas.getContext('2d');
            canvas.width = 400; canvas.height = 500;
            let c=0, r=0;
            for(let i=start; i<=end; i++){
                status.innerText = `ğŸ”„ Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ÙƒÙˆØ¯ ${i}`;
                const div = document.getElementById('temp-qr'); div.innerHTML = "";
                new QRCode(div, {text: i.toString(), width: 300, height: 300});
                await new Promise(res => setTimeout(res, 40));
                ctx.fillStyle = "white"; ctx.fillRect(0,0,400,500);
                ctx.drawImage(div.querySelector('canvas'), 50, 50);
                ctx.fillStyle = "black"; ctx.font = "bold 45px Cairo"; ctx.textAlign="center";
                ctx.fillText(i.toString(), 200, 420);
                doc.addImage(canvas.toDataURL("image/png"), 'PNG', 10+(c*(w+sp)), 10+(r*(h+sp)), w, h);
                c++; if(c>=cols){ c=0; r++; }
                if(r>=rows && i<end){ doc.addPage(); c=0; r=0; }
            }
            doc.save(`${customName}.pdf`); status.innerText = "âœ… ØªÙ… Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²!";
        }

        async function processExcel() {
            const fileInput = document.getElementById('t4Excel'), status = document.getElementById('statusT4'), customName = document.getElementById('t4Name').value || "Excel_QR_Labels";
            if(!fileInput.files[0]) return alert("Ø§Ø®ØªØ± Ù…Ù„Ù Ø¥ÙƒØ³ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹");
            status.innerText = "â³ Ø¬Ø§Ø±ÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...";
            try {
                const workbook = XLSX.read(await fileInput.files[0].arrayBuffer());
                const json = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
                if(json.length === 0) throw new Error("Ø§Ù„Ù…Ù„Ù ÙØ§Ø±Øº");
                const keys = Object.keys(json[0]);
                const qrKey = keys.find(k => ['qr', 'id', 'code', 'ÙƒÙˆØ¯'].includes(k.toLowerCase()));
                const nameKey = keys.find(k => ['Ø§Ù„Ø§Ø³Ù…', 'name', 'Name'].includes(k.toLowerCase()));
                if(!qrKey) throw new Error("ÙŠØ¬Ø¨ ÙˆØ¬ÙˆØ¯ Ø¹Ù…ÙˆØ¯ Ø¨Ø§Ø³Ù… (qr Ø£Ùˆ id Ø£Ùˆ code)");
                const { jsPDF } = window.jspdf; const doc = new jsPDF('p', 'mm', 'a4');
                const cols = parseInt(document.getElementById('t4Cols').value), rows = parseInt(document.getElementById('t4Rows').value), sp = parseInt(document.getElementById('t4Spacing').value);
                const w = (190 - (sp*(cols-1)))/cols, h = (277 - (sp*(rows-1)))/rows;
                const canvas = document.getElementById('finalCanvas'); const ctx = canvas.getContext('2d');
                canvas.width = 400; canvas.height = 500;
                let c=0, r=0;
                for(let i=0; i < json.length; i++) {
                    const qrVal = String(json[i][qrKey] || ""), nameVal = nameKey ? String(json[i][nameKey] || "") : qrVal;
                    status.innerText = `ğŸ”„ Ù…Ø¹Ø§Ù„Ø¬Ø©: ${nameVal}`;
                    const div = document.getElementById('temp-qr'); div.innerHTML = "";
                    new QRCode(div, {text: qrVal, width: 300, height: 300});
                    await new Promise(res => setTimeout(res, 40));
                    ctx.fillStyle = "white"; ctx.fillRect(0, 0, 400, 500);
                    ctx.drawImage(div.querySelector('canvas'), 50, 50);
                    ctx.fillStyle = "black"; ctx.font = "bold 35px Cairo"; ctx.textAlign = "center";
                    ctx.fillText(nameVal, 200, 420);
                    doc.addImage(canvas.toDataURL("image/png"), 'PNG', 10+(c*(w+sp)), 10+(r*(h+sp)), w, h);
                    c++; if(c >= cols) { c=0; r++; }
                    if(r >= rows && i < json.length - 1) { doc.addPage(); c=0; r=0; }
                }
                doc.save(`${customName}.pdf`); status.innerText = "âœ… ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„!";
            } catch (err) { alert("Ø®Ø·Ø£: " + err.message); status.innerText = "âŒ ÙØ´Ù„"; }
        }

        async function processIDCards() {
    const excelFile = document.getElementById('t5Excel').files[0];
    const sLogoFile = document.getElementById('t5ServiceLogo').files[0];
    const lLogoFile = document.getElementById('t5LevelLogo').files[0];
    const themeColor = document.getElementById('t5Color').value;
    
    // Ø¹Ù†Ø§ØµØ± Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
    const container = document.getElementById('progressContainerT5');
    const bar = document.getElementById('progressBarT5');
    const percentTxt = document.getElementById('percentTextT5');
    const actionTxt = document.getElementById('currentActionT5');
    const personTxt = document.getElementById('currentPersonT5');
    const statusTxt = document.getElementById('statusT5');

    if(!excelFile) return alert("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³ÙŠÙ„");

    // Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… ÙˆØªØµÙÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©
    container.classList.remove('hidden');
    statusTxt.innerText = "";
    bar.style.width = "0%";
    percentTxt.innerText = "0%";

    try {
        actionTxt.innerText = "Ø¬Ø§Ø±ÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„ÙØ§Øª...";
        const readImg = (file) => file ? new Promise(r => { const fr = new FileReader(); fr.onload=e=>r(e.target.result); fr.readAsDataURL(file); }) : null;
        const sLogoImg = await readImg(sLogoFile);
        const lLogoImg = await readImg(lLogoFile);
        
        const sName = document.getElementById('t5ServiceName').value || "";
        const rawLevelName = document.getElementById('t5LevelName').value || "";
        const lName = rawLevelName ? "" + rawLevelName : ""; //Ø§Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ø¶Ø§ÙØ© ÙƒÙ„Ù…Ø© Ø«Ø§Ø¨ØªÙ‡ Ù‚Ø¨Ù„ Ø§Ù„Ø³Ù… Ø§Ù„Ù…Ø±Ø­Ù„Ù‡ (ÙØ±ÙŠÙ‚ Ø§Ùˆ ÙØµÙ„ Ø§ÙˆÙ…Ø¬Ù…ÙˆØ¹Ø©)

        const workbook = XLSX.read(await excelFile.arrayBuffer());
        const json = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
        const total = json.length;

        const { jsPDF } = window.jspdf;
        const doc = new jsPDF({ orientation: 'p', unit: 'mm', format: 'a4', compress: true });
        
        const cardW = 65, cardH = 40, marginX = 7.5, marginY = 10;
        const canvas = document.getElementById('finalCanvas');
        const ctx = canvas.getContext('2d', { alpha: false });
        const scale = 3; 
        canvas.width = 650 * scale; 
        canvas.height = 400 * scale; 
        ctx.scale(scale, scale);

        let c=0, r=0;

        for(let i=0; i < total; i++) {
            const qrVal = String(json[i][json[i].hasOwnProperty('qr') ? 'qr' : Object.keys(json[i])[0]] || "");
            const nameVal = json[i][Object.keys(json[i]).find(k => k.includes('Ø§Ù„Ø§Ø³Ù…') || k.toLowerCase().includes('name'))] || "-----------------";
            
            // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
            const percent = Math.round(((i + 1) / total) * 100);
            bar.style.width = percent + "%";
            percentTxt.innerText = percent + "%";
            actionTxt.innerText = `Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ÙƒØ§Ø±Øª (${i + 1} Ù…Ù† ${total})`;
            personTxt.innerText = nameVal;

            // ØªÙˆÙ„ÙŠØ¯ QR
            const div = document.getElementById('temp-qr'); div.innerHTML = "";
            new QRCode(div, {text: qrVal, width: 400, height: 400, correctLevel: QRCode.CorrectLevel.H});
            await new Promise(res => setTimeout(res, 30)); // Ù…Ù‡Ù„Ø© Ù‚ØµÙŠØ±Ø© Ù„Ù„Ø³Ù…Ø§Ø­ Ù„Ù„Ù…ØªØµÙØ­ Ø¨ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            const qrCanvas = div.querySelector('canvas');

            // Ø±Ø³Ù… Ø§Ù„ÙƒØ§Ø±Øª
            ctx.fillStyle = "white";
            ctx.fillRect(0, 0, 650, 400);
            ctx.strokeStyle = themeColor;
            ctx.lineWidth = 15; 
            ctx.strokeRect(0, 0, 650, 400);

            if(sLogoImg) {
                const img = await new Promise(r => {const i=new Image(); i.onload=()=>r(i); i.src=sLogoImg;});
                ctx.drawImage(img, 650 - 110, 20, 85, 85); 
            }
            if(lLogoImg) {
                const img = await new Promise(r => {const i=new Image(); i.onload=()=>r(i); i.src=lLogoImg;});
                ctx.drawImage(img, 25, 20, 85, 85); 
            }

            ctx.textAlign = "center";
            ctx.fillStyle = "#1e293b"; ctx.font = "bold 27px Cairo"; 
            ctx.fillText(sName, 325, 50);
            ctx.font = "bold 22px Cairo"; ctx.fillStyle = "#64748b";
            ctx.fillText(lName, 325, 85);

            ctx.beginPath(); ctx.moveTo(120, 105); ctx.lineTo(530, 105);
            ctx.lineWidth = 2; ctx.strokeStyle = "#e2e8f0"; ctx.stroke();

            ctx.drawImage(qrCanvas, 45, 135, 210, 210);
            ctx.textAlign = "right";
            ctx.fillStyle = themeColor; ctx.font = "bold 34px Cairo";
            ctx.fillText(nameVal.split(' ').slice(0, 3).join(' '), 600, 215); 
            ctx.fillStyle = "#334155"; ctx.font = "bold 28px Cairo";
            ctx.fillText(`ÙƒÙˆØ¯: ${qrVal}`, 600, 275); 

            doc.addImage(canvas.toDataURL("image/png", 1.0), 'PNG', marginX+(c*cardW), marginY+(r*cardH), cardW, cardH, undefined, 'FAST');
            
            c++; if(c >= 3) { c=0; r++; }
            if(r >= 7 && i < total - 1) { doc.addPage(); c=0; r=0; }
        }

        actionTxt.innerText = "Ø¬Ø§Ø±ÙŠ Ø­ÙØ¸ Ù…Ù„Ù PDF...";
        doc.save(`${document.getElementById('t5FileName').value || 'ID_Cards'}.pdf`);
        
        // Ø§Ù„Ù†Ø¬Ø§Ø­
        statusTxt.innerText = "âœ… ØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø¨Ù†Ø¬Ø§Ø­!";
        personTxt.innerText = "ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù";
        setTimeout(() => container.classList.add('hidden'), 5000); // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø´Ø±ÙŠØ· Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ

    } catch (err) {
        console.error(err);
        statusTxt.innerText = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£: " + err.message;
        container.classList.add('border-red-500');
    }
}

        window.onload = () => showTool(4);
    </script>
</body>
</html>
